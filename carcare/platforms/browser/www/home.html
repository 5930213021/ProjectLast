<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>MCarcare</title>

  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">

  <link href="https://fonts.googleapis.com/css?family=Archivo+Black&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Bai+Jamjuree|Lato&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Athiti:300,400,500|Sarabun:200&display=swap" rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="css/home.css">


  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">

  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous"></script>
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
  <script src="js/ejs.js"></script>
  <script src="cordova.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>

  <script>
        // Initialize Firebase
  </script>

</head>

<body>
  <ons-navigator id="appNavigator" swipeable swipe-target-width="80px">
    <ons-page>
      <ons-splitter id="appSplitter">
        <ons-splitter-side id="sidemenu" page="sidemenu.html" swipeable side="right" collapse="" width="260px">
        </ons-splitter-side>
        <ons-splitter-content page="tabbar.html"></ons-splitter-content>
      </ons-splitter>
    </ons-page>

    <ons-modal direction="up">
      <div style="text-align: center">
        <p>
          <ons-icon icon="md-spinner" size="28px" spin></ons-icon> Loading...
        </p>
      </div>
    </ons-modal>

  </ons-navigator>

  <template id="tabbar.html">
    <ons-page id="tabbar-page">
      <ons-toolbar id="headbar">
        <div class="center" id="appname">Mcarcare</div>
        <div class="right">
          <ons-toolbar-button onclick="fn.toggleMenu()">
            <ons-icon icon="ion-navicon, material:md-menu" style="color: rgb(1, 100, 117);"></ons-icon>
          </ons-toolbar-button>
        </div>
      </ons-toolbar>

      <ons-tabbar swipeable position="auto" id="appTabbar">
        <ons-tab page="home2.html" label="หน้าหลัก" icon="ion-home, material:md-home" badge="1" active></ons-tab>
        <ons-tab page="booking.html" label="จองคิว" icon="fa-car" active-icon="fa-car" id="books" onclick="book()">
        </ons-tab>
        <ons-tab page="message.html" label="ข้อความ" icon="fa-envelope" badge="1"></ons-tab>
        <ons-tab page="history.html" label="ประวัติฯ" icon="fa-list-ul"></ons-tab>
      </ons-tabbar>

      <script>
        ons.getScriptPage().addEventListener('prechange', function (event) {
          if (event.target.matches('#appTabbar')) {
            event.currentTarget.querySelector('ons-toolbar .center').innerHTML = event.tabItem.getAttribute('label');
          }
        });
      </script>
    </ons-page>
  </template>

  <template id="sidemenu.html">
    <ons-page>
      <!-- <div class="profile-pic">
            <img src="img/picpro3.gif">
        </div> -->

      <ons-list-title><br></ons-list-title>
      <!-- เมนู -->
      <ons-list>
        <ons-list-item onclick="window.location.href='profile2.html'">

          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-account, material:md-account"></ons-icon>
          </div>
          <div class="center">ข้อมูลส่วนตัว
          </div>
        </ons-list-item>

        <ons-list-item onclick="fn.loadView(0)">
          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-home, material:md-home"></ons-icon>
          </div>
          <div class="center">หน้าหลัก</div>
          <!-- <div class="right">
                    <ons-icon icon="fa-link"></ons-icon>
                </div> -->
        </ons-list-item>
        <ons-list-item onclick="fn.loadView(1)">
          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-car, material:md-car"></ons-icon>
          </div>
          <div class="center">จองคิว</div>
        </ons-list-item>
        <ons-list-item onclick="fn.loadView(2)">
          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-envelope, material:md-email">
            </ons-icon>
          </div>
          <div class="center">ช้อความ</div>
        </ons-list-item>
        <ons-list-item onclick="fn.loadView(3)">
          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-view-headline, material:md-view-headline">
            </ons-icon>
          </div>
          <div class="center">ประวัติการใช้งาน</div>
        </ons-list-item>

        <ons-list-item onclick="showModal()">
          <div class="left">
            <ons-icon fixed-width class="list-item__icon" icon="ion-power, material:md-power""></ons-icon>
                </div>
                <div class=" center">ออกจากระบบ
          </div>
        </ons-list-item>
      </ons-list>

    </ons-page>
  </template>

  <template id="home2.html" var="MyNav">
    <ons-page><br>
      <ons-list modifier="inset">
        <ons-list-item expandable>
          คู่มือการใช้งาน
          <div class="expandable-content">ผู้ใช้ต้องทำการกรอกข้อมูลส่วนตัวและแก้ไขได้
            คุณสามารถทำรายการจองเวลาเลือกการล้างที่คุณต้องการ </div>
        </ons-list-item>
      </ons-list>

      <div style="height: 200px; padding: 1px 0 0 0;">
        <div class="card">
          <div class="list-item">
            <div class="list-item__left">
              <img class="list-item__thumbnail" src="img/mirage-1284.jpg" alt="Cute kitten">
            </div>

            <div class="list-item__center">
              <div class="list-item__title">วันจันทร์ 14 ก.พ. 2562 (11.00-12.00)</div>
              <div class="list-item__subtitle">ล้างห้องเครื่อง</div>

            </div>
          </div>
        </div>
      </div>
    </ons-page>
  </template>

  <template id="booking.html">
    <ons-page>
      <section>
        <p id="book">
          เวลาจอง
        </p>
      </section>
      <!-- <ons-list modifier="inset">
        <ons-list-header>8.00 - 9.30</ons-list-header>
        <ons-list-item>
          <button class="button--cta" id="set1" style="width: 50%; margin: 0 auto;">ไม่ว่าง</button>
          <button class="button--cta" id="set2" style="width: 50%; margin: 0 auto;">ว่าง</button>
        </ons-list-item>
      </ons-list><br> -->
      <div class="row" id="data2">
        default
      </div>


      <!-- <ons-list modifier="inset">
        <ons-list-header>7.30 - 8.00</ons-list-header>
        <ons-list-item>
          <button class="button--cta" disabled id="set1" style="width: 100%; margin: 0 auto;">ไม่ว่าง</button>
        </ons-list-item>
      </ons-list><br>

      <ons-list modifier="inset">
        <ons-list-header>8.00 - 9.30</ons-list-header>
        <ons-list-item>
          <button class="button--cta" id="set2" onclick="" style="width: 100%; margin: 0 auto;">ว่าง</button>
        </ons-list-item>
      </ons-list><br>
      <ons-list modifier="inset">
        <ons-list-header>9.30 - 11.00</ons-list-header>
        <ons-list-item>
          <button class="button--cta" id="set2" style="width: 100%; margin: 0 auto;">ว่าง</button>
        </ons-list-item>
      </ons-list><br> -->


    </ons-page>
  </template>

  <template id="message.html">
    <ons-page><br>
      <div class="card" id="bor">
        <h3 class="card__title">วันจันทร์ 14 ก.พ. 2562</h3>
        <div class="card__content">รถของท่านได้ทำการล้างเสร็จเรียบร้อยแล้ว ท่านสามารถเข้ามารับรถได้เลยค่ะ</div>
      </div>
    </ons-page>
  </template>

  <template id="history.html">
    <ons-page><br>
      <!-- <div style="height: 200px; padding: 1px 0 0 0;">
        <div class="card">
            <div class="list-item__left list-item--material__left">
                <img class="list-item__thumbnail list-item--material__thumbnail" src="https://placekitten.com/g/42/41" alt="Cute kitten">
              </div>
          <div class="card__content">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
            incididunt ut labore et dolore magna aliqua.</div>
        </div>
      </div> -->
      <div style="height: 200px; padding: 1px 0 0 0;">
        <div class="card">
          <div class="list-item">
            <div class="list-item__left">
              <img class="list-item__thumbnail" src="img/mirage-1284.jpg" alt="Cute kitten">
            </div>

            <div class="list-item__center">
              <div class="list-item__title">วันจันทร์ 14 ก.พ. 2562</div>
              <div class="list-item__subtitle">ล้างอัดฉีดช่วงล้าง <br>
                ล้างสีดูดฝุ่น</div>
            </div>
          </div>
        </div>
      </div>


    </ons-page>
  </template>

  <template id="select_car.html">
    <ons-page>
      <div class="background"></div>
      <p>
        <!-- modifier="quiet" id="btnback" -->
        <ons-back-button>
          <ons-icon icon="md-chevron-left"></ons-icon>
          กลับ
        </ons-back-button>
      </p>
      <div class="namedata">รถของท่าน</div>

      <div class="row" id="showcar">
        default
      </div>

    </ons-page>
  </template>


  <template id="detailbook.html">
    <ons-page>
      <div class="background"></div>
      <p>
        <!-- <ons-button onclick="window.location.href='home.html'" modifier="quiet" id="btnback">
          <ons-icon icon="md-chevron-left"></ons-icon>
          กลับ
        </ons-button> -->
        <ons-back-button>Back</ons-back-button>
      </p>
      <div class="namedata">รายละเอียดข้อมูล</div>
      <div class="picuser">
        <ons-list-item>
          <div class="center">
            <img class="list-item__thumbnail" src="img/mirage-1284.jpg" id="pic">
          </div>
        </ons-list-item>
      </div>

      <div class="row" id="data3">
        default
      </div>

      <div class="namedata">เลือกประเภทการล้าง</div>
      <form method="POST">
      <ons-row style="margin-top: 15px;">
        <ons-col style="flex: 0 0 70%;margin: auto;max-width: 100%;margin-bottom: 10px;">
            <ons-list>
                <ons-list-item >
                  <label class="left">
                    <ons-checkbox input-id="wash" value="ล้างห้องเครื่อง"></ons-checkbox>
                  </label>
                  <label for="wash" class="center">
                      ล้างห้องเครื่อง
                  </label>
                </ons-list-item>
                <ons-list-item >
                    <label class="left">
                      <ons-checkbox input-id="spary" value="ล้างอัดฉีดช่วงล้าง"></ons-checkbox>
                    </label>
                    <label for="spary" class="center">
                        ล้างอัดฉีดช่วงล้าง
                    </label>
                  </ons-list-item>
                  <ons-list-item >
                      <label class="left">
                        <ons-checkbox input-id="color" value="ล้างสีดูดฝุ่น"></ons-checkbox>
                      </label>
                      <label for="color" class="center">
                          ล้างสีดูดฝุ่น
                      </label>
                    </ons-list-item>
                    <ons-list-item >
                        <label class="left">
                          <ons-checkbox input-id="fuel" value="ล้างยางมะตอย"></ons-checkbox>
                        </label>
                        <label for="fuel" class="center">
                            ล้างยางมะตอย
                        </label>
                      </ons-list-item>
                      <ons-list-item >
                          <label class="left">
                            <ons-checkbox input-id="dust" value="ถ่ายน้ำมันเครื่อง(มอเตอร์ไซต์)"></ons-checkbox>
                          </label>
                          <label for="dust" class="center">
                              ถ่ายน้ำมันเครื่อง(มอเตอร์ไซต์)
                          </label>
                        </ons-list-item>
            </ons-list>          
        </ons-col>
  

        <div class="warn">
          กรุณากรอกข้อมูลของท่านให้ครบถ้วน เพื่อประโยชน์ของตัวลูกค้าเอง
        </div>
      </ons-row>
  </form>
      <div class="setbtn">
        <ons-button onclick="insert()" id="btnsubmit">
          ยืนยัน
        </ons-button>
        <!-- <ons-button id="btnsubmit">
          ยืนยัน
        </ons-button> -->
      </div>
    </ons-page>
  </template>

</body>

<script>


  window.onload = async function () {
    console.log("phone" + localStorage.getItem("phone"));
    let book = await localStorage.getItem("green");
    console.log("statusbook:" + book);
    alert(localStorage.getItem('save'));

  };


  window.fn = {};

  window.fn.toggleMenu = function () {
    document.getElementById('appSplitter').right.toggle();
  };

  window.fn.loadView = function (index) {
    document.getElementById('appTabbar').setActiveTab(index);
    document.getElementById('sidemenu').close();
  };

  window.fn.loadLink = function (url) {
    window.open(url, '_blank');
  };

  window.fn.pushPage = function (page, anim) {
    if (anim) {
      document.getElementById('appNavigator').pushPage(page.id, { data: { title: page.title }, animation: anim });
    } else {
      document.getElementById('appNavigator').pushPage(page.id, { data: { title: page.title } });
    }
  };

  window.fn.load = function (page) {
    var myNavigator = document.getElementById('appNavigator');

    menu.close();
    myNavigator.resetToPage(page, { animation: 'fade' });
  };


  //Showreload
  function showModal() {
    var modal = document.querySelector('ons-modal');
    modal.show();
    setTimeout(function () {
      // modal.hide();
      window.location.href = 'login.html';
    }, 1500);
  }

  function book() {
    axios.get('http://localhost:8080/user/showtimes')
      .then(function (response) {
        var dc = [];
        let data = response.data
        data.forEach(element => {
          dc += '<ons-list modifier="inset">' +
            '<ons-list-header>' + element.times + '</ons-list-header>' +
            '<ons-list-item>' +
            '<button class="button--cta" style="width: 100%; margin: 0 auto;" id="set2" onclick="check()">ว่าง</button>' +
            '</ons-list-item>' +
            '</ons-list><br>'

          // dc +=
          //   '<ons-list modifier="inset">' +
          //   '<ons-list-header>' + element.times + '</ons-list-header>' +
          //   '<ons-list-item>' +
          //   '<button class="button--cta" id="set2" style="width: 50%; margin: 0 auto;" onclick="check()">ว่าง</button>' +
          //   '<button class="button--cta" id="set4" style="width: 50%; margin: 0 auto;" onclick="check()">ว่าง</button>' +
          //   '</ons-list-item>' +
          //   '</ons-list><br>'
        })
        myobj = document.getElementById("data2");
        myobj.innerHTML = dc;
        console.log(myobj);
      })
      .catch(function (error) {
        // handle error
        console.log(error);
      })
  }


  // var count = 1;
  // localStorage.setItem("count", count);

  // var check = function () {
  //   var count = localStorage.getItem("save");

  //   if (count == 2) {
  //     alert("แล้วววว");
  //     console.log(count);
  //     appNavigator.pushPage('detailbook.html')
  //     localStorage.clear();
  //   } else {
  //     alert("จอง");
  //     console.log(count);
  //     // count += 1;
  //     appNavigator.pushPage('detailbook.html')
  //     // document.getElementById('set2').id = 'set1';

  //   }
  // };

  var check = function () {
    if ('#set2') {
      appNavigator.pushPage('select_car.html')
      let phone = localStorage.getItem("phone");
      axios.get('http://localhost:8080/user/getshowcar/' + phone)
        .then(function (response) {
          var dc = [];
          let data = response.data
          console.log(data);
          data.forEach(element => {
           
            dc +=
              '<ons-card onclick=selectwork("'+element.car_num+'")>' +
              '<div class="carnum">' + element.car_num + '</div>' +
              '<div class="datailcar">' + element.type + element.color + '</div>' +
              '</ons-card>'
          })
          myobj = document.getElementById("showcar");
          myobj.innerHTML = dc;
          // localStorage.setItem("car_num" , car_num);
          console.log(myobj);
        })
        .catch(function (error) {
          // handle error
          console.log(error);
        })
    }
  }


  var selectwork = function (car_num) {
   
      appNavigator.pushPage('detailbook.html')
      console.log("car_num"+car_num)
      axios.get('http://localhost:8080/user/showdetailuser/' + encodeURIComponent(car_num))
        .then(function (response) {
          var dc = [];
          let data = response.data
          console.log("response:"+data);
          data.forEach(element => {
            dc +=
              '<ons-card><div class="title">ชื่อ :' + element.fname +
              '</div>' +
              '<div class="title">เบอร์โทรฯ :' + element.phone +
              '</div>' +
              '<div class="title">ป้ายทะเบียน :' + element.car_num +
              '</div>' +
              '<div class="title">ประเภทรถ :' + element.type +
              '</div>' +
              '<div class="title">สีรถ :' + element.color +
              '</div>' +
              '</ons-card>'
          })
          let myobj = document.getElementById("data3");
          myobj.innerHTML = dc;
          console.log(myobj);
        })
        .catch(function (error) {
          // handle error
          console.log(error);
        })
  
  }

  // $("#btnsubmit").click(function () {
  //   console.log("test");
  //   // set storage
  //   localStorage.setItem("green", $("#set2").val());
  //   window.location = "home.html";
  // });

  // $(document).ready(function () {
  //   // get value from storage
  //   // button click
  //   $("#books").click(function () {
  //     $("#set1").html(localStorage.getItem("green"));

  //   });
  // });


  async function insert() {
   
        let wash = 0
        let spary = 0
        let color = 0
        let fuel = 0
        let dust = 0
    
        console.log(wash,spary,color,fuel,dust)
        if(document.getElementById('wash').checked == true){
          wash = 1
        }
        if(document.getElementById('spary').checked == true){
          spary = 1
        }
        if(document.getElementById('color').checked == true){
          color = 1
        }
        if(document.getElementById('fuel').checked == true){
          fuel = 1
        }
        if(document.getElementById('dust').checked == true){
          dust = 1
        }
        // postAPI(phone,fname,lname)
       
    


    // console.log("comein Insert")
    // await localStorage.setItem("green", "#set2");
    // console.log("testbook:" + localStorage.getItem("save"))
    // window.location.href = 'home.html';
  }
</script>

</html>